<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>MDM Access Code</title>
    <link rel="stylesheet" href="./style.css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans:wght@400;500;700&display=swap" rel="stylesheet">
</head>
<body>
    <div class="zhengti">
        <div class="juzuo1">
            V25110041(Đinh Văn Cường)
        </div>
        <div class="card">
            <div class="top-banner" id="biaoti">
                将二维码对准扫描器扫码进出场
            </div>
            
            <div class="erweima">
                <div class="juzuo2" id="dateTime00"></div>
                
                <div id="neirong">
                    <img class="ewm" src="./ewm.gif"> 
                    <a class="shuaxinerweima" href="javascript:location.reload()">刷新二维码</a>
                </div>
                
                <div class="yishengxiao" onclick="changetxt()">
                    已生效
                </div>
                
                <div class="shijian" id="dateTime3">00:00</div>
            </div>
        </div>
        
        <div class="dierhang">
            尊敬的员工您好，您已进入企业涉密区域，出于企业安全考虑，您的手机摄像头将被禁止拍摄，感谢您的配合。
        </div>
    </div>

    <script>
        // Hàm format ngày giờ
        Date.prototype.format = function (fmt) {
            var o = {
                "y+": this.getFullYear(), "M+": this.getMonth() + 1, "d+": this.getDate(), 
                "h+": this.getHours(), "m+": this.getMinutes(), "s+": this.getSeconds(), 
            };
            if (/(y+)/.test(fmt)) fmt = fmt.replace(RegExp.$1, (this.getFullYear() + "").substr(4 - RegExp.$1.length));
            for (var k in o)
                if (new RegExp("(" + k + ")").test(fmt)) fmt = fmt.replace(RegExp.$1, (RegExp.$1.length == 1) ? (o[k]) : (("00" + o[k]).substr(("" + o[k]).length)));
            return fmt;
        }

        // Cập nhật ngày giờ hiện tại
        setInterval(function () {
          const dt = document.getElementById('dateTime00');
          if (dt) {
            dt.innerHTML = (new Date()).format('yyyy-M-d hh:mm:ss');
          }
        }, 1000);

        // Hàm giả lập check-in thành công (Giữ nguyên nội dung gốc)
        function changetxt(){
            document.getElementById('biaoti').innerText="您的设备已符合安全规范";
            // ... (Phần hiển thị ảnh/chữ thành công - bạn có thể thêm logic hiển thị ảnh 'true.png' ở đây nếu có tệp)
            document.getElementById('neirong').innerHTML = "<div><p class='jinchang'>进场成功</p><p class='riqi' id='dateTime01'></p></div>";
            document.querySelector('.yishengxiao').style.display = 'none'; // Ẩn chữ '已生效' sau khi click

            setInterval(function () {
                const dt = document.getElementById('dateTime01');
                if (dt) {
                    dt.innerHTML = (new Date()).format('yyyy-MM-dd hh:mm');
                }
            }, 1000);
        }

        // Logic Đồng hồ đếm thời gian (LOẠI BỎ LOGIC RESET 12H)
        let startTime = localStorage.getItem("startTime");
        if (!startTime) {
            startTime = Date.now();
            localStorage.setItem("startTime", startTime);
        } else {
            startTime = parseInt(startTime);
        }

        setInterval(function () {
            let diff = Math.floor((Date.now() - startTime) / 1000); // giây
            let hrs = Math.floor(diff / 3600);
            let mins = Math.floor((diff % 3600) / 60);
            let secs = diff % 60;

            let timeString = '';
            if (hrs > 0) {
                // h:mm:ss
                timeString = hrs + ':' + (mins < 10 ? '0' : '') + mins + ':' + (secs < 10 ? '0' : '') + secs;
            } else {
                // mm:ss
                timeString = (mins < 10 ? '0' : '') + mins + ':' + (secs < 10 ? '0' : '') + secs;
            }
            document.getElementById('dateTime3').innerHTML = timeString;
        }, 1000);
    </script>
</body>
</html>
